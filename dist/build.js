(()=>{"use strict";const t={template:'<div>\n    <button class="cart-button" @click="openCartHandler" type="button">Корзина</button>\n    <div v-if="isVisibleCart" v-on:click="removeHandler">\n      <slot></slot>\n    </div>\n  </div>',data:()=>({isVisibleCart:!1}),methods:{openCartHandler(){this.isVisibleCart=!this.isVisibleCart},removeHandler(t){this.$emit("remove",t)}}},e={template:'<div><input id="search" v-model="search"><button v-on:click="searchHandler">SEARCH</button></div>',data:()=>({search:""}),methods:{searchHandler(){this.$emit("search",this.search)}}};Vue.component("goods-item",{template:'<div :data-id="id" class="goods-item"><h3>{{ title }}</h3><p>{{ price }}</p></div>',props:["title","price","id"]}),new Vue({el:"#app",components:{Cart:t,Search:e},data:{cart:[],goods:[],filtredGoods:[],search:"",isLoaded:!1},methods:{addToCartHandler(t){const e=t.target.closest(".goods-item").dataset.id,s=this.goods.find((t=>t.id==e));fetch("/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),this.cart.push(s),console.log(this.cart)},removeFromCartHandler(t){const e=t.target.closest(".goods-item").dataset.id,s=this.cart.findIndex((t=>t.id==e));fetch("/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:delete JSON[s]}),this.cart.splice(s-1,1),console.log(this.cart)},searchHandler(t){""===t&&(this.filtredGoods=this.goods);const e=new RegExp(t,"gi");this.filtredGoods=this.goods.filter((t=>e.test(t.title)))}},mounted(){fetch("/data").then((t=>t.json())).then((t=>{this.goods=t,this.filtredGoods=t,this.isLoaded=!0})).catch((t=>{console.log(t)})),fetch("/cart").then((t=>t.json())).then((t=>{this.cart=t})).catch((t=>{console.log(t)}))}})})();